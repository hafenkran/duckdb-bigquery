# name: test/sql/storage/attach_limit.test
# description: Test LIMIT over an attached BigQuery table
# group: [storage]

require bigquery

require-env BQ_ATTACH_DB_URL

statement ok
ATTACH 'project=test api_endpoint=http://${BQ_ATTACH_DB_URL}:9050 grpc_endpoint=${BQ_ATTACH_DB_URL}:9060' AS test (TYPE bigquery);

statement ok
DROP TABLE IF EXISTS test.dataset1.table_limit

statement ok
CREATE TABLE test.dataset1.table_limit AS FROM range(100000) t(i)

query I
FROM test.dataset1.table_limit LIMIT 5
----
0
1
2
3
4

query I
FROM test.dataset1.table_limit LIMIT 5 OFFSET 5
----
5
6
7
8
9
