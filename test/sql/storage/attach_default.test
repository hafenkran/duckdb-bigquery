# name: test/sql/storage/attach_defaults.test
# description: Testing DEFAULT statement
# group: [storage]

require bigquery

require-env BQ_ATTACH_DB_URL

statement ok
ATTACH 'project=test api_endpoint=http://${BQ_ATTACH_DB_URL}:9050 grpc_endpoint=${BQ_ATTACH_DB_URL}:9060' AS test (TYPE bigquery);

statement ok
CREATE TABLE test.dataset1.defaults_table (i INTEGER DEFAULT 5, s STRING DEFAULT 'some_default');

statement ok
INSERT INTO test.dataset1.defaults_table (i) VALUES (3);

statement ok
INSERT INTO test.dataset1.defaults_table (s) VALUES ('new string');

query II
SELECT * FROM test.dataset1.defaults_table;
----
3	'some_default'
5	'new string'

statement ok
INSERT INTO test.dataset1.defaults_table (i, s) VALUES (15, 'deluxe string');

statement error
INSERT INTO test.dataset1.defaults_table (sinep) VALUES (96)
----
does not have a column with name "sinep"
