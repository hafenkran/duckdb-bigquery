# name: test/sql/storage/attach_types_timestamptz.test
# description: Test inserting timestamp with time zones
# group: [storage]

require bigquery

require-env BQ_ATTACH_DB_URL

statement ok
ATTACH 'project=test api_endpoint=http://${BQ_ATTACH_DB_URL}:9050 grpc_endpoint=${BQ_ATTACH_DB_URL}:9060' AS test (TYPE bigquery);

statement ok
DROP TABLE IF EXISTS test.dataset1.table_timestamp_with_tz;

statement ok
CREATE TABLE test.dataset1.table_timestamp_with_tz(ts TIMESTAMP WITH TIME ZONE);


# Insert various timestamps with different time zones
# UTC time zone
statement ok
INSERT INTO test.dataset1.table_timestamp_with_tz VALUES (TIMESTAMP '2000-01-01 12:12:12+00');

# Eastern Standard Time
statement ok
INSERT INTO test.dataset1.table_timestamp_with_tz VALUES (TIMESTAMP '2000-01-01 12:12:12-05');

# Japan Standard Time
statement ok
INSERT INTO test.dataset1.table_timestamp_with_tz VALUES (TIMESTAMP '2000-01-02 23:59:59+09');

# Pacific Standard Time
statement ok
INSERT INTO test.dataset1.table_timestamp_with_tz VALUES (TIMESTAMP '2000-12-31 16:00:00-08');


# Query to select all entries in the table
query I rowsort
SELECT * FROM test.dataset1.table_timestamp_with_tz
----
2000-01-01 12:12:12+00
2000-01-01 17:12:12+00
2000-01-02 14:59:59+00
2001-01-01 00:00:00+00


# Cleanup to speed up other tests
statement ok
DROP TABLE IF EXISTS test.dataset1.table_timestamp_with_tz;
